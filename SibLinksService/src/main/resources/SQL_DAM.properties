CREATE_QUESTION=INSERT INTO `Sib_Forum_Post` (`authorID`, `subjectId`, `content`,`imagePath`, `timeStamp`, `updateTime`) VALUES ( ?,?,?, ?, now(), now());
ADD_IMAGE_QUESTION = INSERT INTO `Sib_Post_Ask_Image`(`qid`,`image`) VALUES(?,?);
GET_ALL_CATEGORY_TOPIC = SELECT subjectId,`subject`,image,`level`,isForum from Sib_Category ORDER BY displaySort ASC
GET_ALL_QUESTION = SELECT  pid,content,`timeStamp`,subjectId,topicId FROM Sib_Forum_Post ORDER BY `timeStamp` DESC LIMIT 300;
GET_ALL_QUESTION_MENTOR_BY_TOPIC_SUBJ = SELECT SFP.pid,SFP.authorID,(SU.firstName||SU.lastName) username,SFP.subjectId,SFP.topicId,SFP.content,UNIX_TIMESTAMP(SFP.`timeStamp`) as datetime, (SELECT COUNT(*) FROM Sib_Forum_Answer WHERE SFP.pid= pid) numanswer,ST.topic,SS.`subject`,SU.imageUrl from Sib_Forum_Post SFP INNER JOIN Sib_Users SU ON SFP.authorID = SU.userid LEFT JOIN Sib_Topic ST ON SFP.topicId= ST.topicId LEFT JOIN Sib_Subject SS ON SFP.subjectId= SS.subjectId WHERE 1 = 1
GET_TOP_MENTORS_MOST_LIKE = SELECT * from( SELECT SU.userid,SU.userName, SU.imageUrl,SU.firstName, SU.lastName , Count(*) as numlike , (SELECT COUNT(*) FROM Sib_Forum_Answer WHERE authorID = SU.userid) AS numanwser from Sib_Users SU INNER JOIN (select SFA.authorID from Sib_Answer_like SAL INNER JOIN Sib_Forum_Answer SFA ON SAL.aid = SFA.aid ) B ON SU.userid = B.authorID where SU.userType = 'M' GROUP BY SU.userid,SU.userName,SU.firstName , SU.lastName )X ORDER BY X.numlike DESC 
GET_STUDENT_SUBCRIBE = SELECT U.userid,U.firstName,U.lastName,U.imageUrl FROM Sib_Users U INNER JOIN Sib_Student_Subcribe S ON U.userid = S.StudentId AND U.userType = 'S' where S.MentorId = ? AND S.Subcribe = 'Y' 
GET_TOTAL_LIKE_VIEW_VIDEO = SELECT U.userid, sum(V.numViews) totalview, sum(V.numLike) totallike FROM Sib_Users U LEFT JOIN Sib_Videos V ON U.userid = V.authorid WHERE U.userType = 'M' AND U.userid = ? GROUP BY U.userid
GET_TOTAL_ANSWERS=SELECT U.userid, Count(*) totalanwer from Sib_Users U INNER JOIN Sib_Forum_Answer A on U.userid = A.authorID WHERE U.userid = ? AND U.userType= "M" GROUP BY U.userid
GET_TOP_MENTORS_BY_LIKE_RATE_SUBS=SELECT X.* FROM(SELECT U.userid, CONCAT(U.lastName,' ', U.firstName) userName,U.lastName, U.firstName, U.imageUrl,(SELECT IFNULL(SUM(numLike),0) from Sib_Forum_Answer where authorID = U.userid ) numlike, ( SELECT count(*) FROM Sib_Student_Subcribe Where U.userid = MentorId ) numsub ,COUNT(V.vid) as numvideos ,U.defaultSubjectId, U.accomplishments, U.bio, (SELECT Count(*) from Sib_Forum_Answer WHERE authorID = U.userid ) numAnswers,AVG(V.averageRating) avgrate 
GET_VIDEOS_BY_PLAYLIST=SELECT L.`Name` AS playlistname, V.vid,U.firstName,U.lastName,U.imageUrl,V.title,V.numViews ,L.subjectId,U.userid ,V.image FROM Sib_PlayList L INNER JOIN Sib_PlayList_Videos PV ON PV.plid = L.plid INNER JOIN Sib_Videos V ON PV.vid = V.vid INNER JOIN Sib_Users U ON U.userid = L.CreateBy WHERE L.plid = ?
CHECK_SUBSCRIBE=SELECT count(*) isSubs FROM Sib_Student_Subcribe where Subcribe \='Y' AND MentorId \= ?  AND StudentId \=?
GET_STUDENT_POSTED = SELECT  P.PID,  U.FIRSTNAME, U.LASTNAME,  P.AUTHORID,  P.TITLE,  P.SUBJECTID,  C. SUBJECT,  P.CONTENT,  P.NUMVIEWS,  P.NUMREPLIES,  UNIX_TIMESTAMP(P. TIMESTAMP) TIMESTAMP,  P.IMAGEPATH FROM  Sib_Forum_Post P INNER JOIN Sib_Category C ON P.subjectId = C.subjectId INNER JOIN Sib_Users U ON U.userid = P.authorID WHERE 1 = 1
GET_STUDENT_POSTED_COUNT = SELECT  COUNT(*) numquestion from Sib_Forum_Post P INNER JOIN Sib_Category C ON P.subjectId = C.subjectId WHERE 1 = 1
SUBSCRIBE_UNSUBSCRIBE_MENTOR= UPDATE Sib_Student_Subcribe set Subcribe = (CASE WHEN Subcribe ='Y' THEN 'N' ELSE 'Y' END) WHERE StudentId  = ? AND MentorId = ?
GET_POST_BY_ID=SELECT SFP.imagePath,SU.userName, SU.firstName, SU.lastName, SU.imageUrl, SU.idFacebook, SU.idGoogle, SFP.pid, SFP.authorID, SFP.title, SFP.subjectId, C.`subject`, SFP.content, SFP.numViews, SFP.numReplies, UNIX_TIMESTAMP(SFP. TIMESTAMP) TIMESTAMP, UNIX_TIMESTAMP(SFP.updateTime) updateTime, SFP.enableFlag FROM Sib_Forum_Post AS SFP JOIN Sib_Users AS SU ON authorID = userid INNER JOIN Sib_Category C on SFP.subjectId = C.subjectId WHERE SFP.pid = ?;
GET_ANSWER_BY_QID = SELECT X.* FROM ( SELECT A.content, A.pid,U.firstName, U.lastName, (SELECT count(*) FROM Sib_Answer_like WHERE aid = A.aid) numlike, U.imageUrl, A.aid, UNIX_TIMESTAMP(A. TIMESTAMP) TIMESTAMP, UNIX_TIMESTAMP(A.updateTime) updateTime FROM Sib_Forum_Answer AS A JOIN Sib_Users AS U ON A.authorID = U.userid WHERE A.pid = ? ) X
POST_EDIT=UPDATE Sib_Forum_Post set imagePath = ?,content=? ,subjectId = ?, updateTime = current_timestamp where pid= ?
GET_VIDEODETAIL_BY_ID = SELECT A.vid, A.title, A.url, A.description, A.image, A.averageRating, U.firstName, U.lastName, UNIX_TIMESTAMP(A.`timeStamp`) timeStamp, A.subjectId, C.`subject`,A.numViews,U.imageUrl avatar,( SELECT count(*) FROM Sib_Student_Subcribe Where U.userid = MentorId AND Subcribe='Y' ) numsub,U.userid  FROM Sib_Videos A INNER JOIN Sib_Users U on A.authorID = U.userid INNER JOIN Sib_Category C on A.subjectId = C.subjectId where A.vid = ?;
GET_COMMENT_VIDEO_BY_VID = SELECT D.content, U.firstName,U.lastName,U.imageUrl,U.userid ,UNIX_TIMESTAMP(D.`timestamp`) `timestamp` from Sib_Video_Comments C INNER JOIN Sib_Comments D ON C.cid = D.cid INNER JOIN Sib_Users U ON D.authorId = U.userid where C.vid = ? ORDER BY D.`timestamp` DESC
CHECK_USER_HISTORY_VIDEO=SELECT * FROM Sib_Video_History WHERE uid = ? AND vid = ?
INSERT_HISTORY_VIDEO=INSERT INTO Sib_Video_History(uid,vid,viewtime) VALUES(?,?,now())
GET_VIDEO_BY_SUBJECTID = SELECT A.vid, A.title, A.url, A.description, A.image, A.averageRating,U.userid, U.firstName, U.lastName, UNIX_TIMESTAMP(A.`timeStamp`) timeStamp, A.subjectId, C.`subject`,A.numViews FROM Sib_Videos A INNER JOIN Sib_Users U on A.authorID = U.userid INNER JOIN Sib_Category C on A.subjectId = C.subjectId where A.subjectId = ?
UPDATE_AVG_RATE = UPDATE Sib_Videos set averageRating = IFNULL(( SELECT IFNULL(SUM(rating),0)+ ? /(COUNT(*)+1) FROm Sib_Video_Rating where vid = ? GROUP BY vid ),?) where vid = ?

