CREATE_QUESTION=INSERT INTO `Sib_Forum_Post` (`authorID`, `subjectId`, `content`,`imagePath`, `timeStamp`, `updateTime`) VALUES ( ?,?,?, ?, now(), now());
ADD_IMAGE_QUESTION = INSERT INTO `Sib_Post_Ask_Image`(`qid`,`image`) VALUES(?,?);
GET_ALL_CATEGORY_TOPIC = SELECT subjectId,`subject`,image,`level`,parentId, isForum from Sib_Category ORDER BY displaySort ASC
GET_ALL_QUESTION = SELECT  pid,content,`timeStamp`,subjectId,topicId FROM Sib_Forum_Post ORDER BY `timeStamp` DESC LIMIT 300;
GET_ALL_QUESTION_MENTOR_BY_SUBJ = SELECT X.* FROM (SELECT SFP.pid,UNIX_TIMESTAMP(SFP. timestamp) `timestamp`,  SFP.authorID, IFNULL(SU.firstName,'') firstName , IFNULL(SU.lastName,'') lastName, SFP.content, UNIX_TIMESTAMP(SFP.`timeStamp`) AS datetime, ( SELECT UNIX_TIMESTAMP(`timeStamp`) FROM Sib_Forum_Answer WHERE pid = SFP.pid AND authorID = ?  ORDER BY aid DESC LIMIT 1 ) timeanswer,SFP.numReplies, SS.`subject`, SS.subjectId, SU.imageUrl, SFP.numViews FROM Sib_Forum_Post SFP INNER JOIN Sib_Users SU ON SFP.authorID = SU.userid INNER JOIN Sib_Category SS ON SFP.subjectId = SS.subjectId ) X WHERE 1 = 1
GET_STUDENT_SUBCRIBE = SELECT U.userid,IFNULL(U.firstName,'') firstName,IFNULL(U.lastName,'') lastName,U.imageUrl FROM Sib_Users U INNER JOIN Sib_Student_Subcribe S ON U.userid = S.StudentId AND U.userType = 'S' where S.MentorId = ? AND S.Subcribe = 'Y' 
GET_TOTAL_LIKE_VIEW_VIDEO = SELECT U.userid, sum(V.numViews) totalview, sum(V.numLike) totallike FROM Sib_Users U LEFT JOIN Sib_Videos V ON U.userid = V.authorid WHERE U.userType = 'M' AND U.userid = ? GROUP BY U.userid
GET_TOTAL_ANSWERS=SELECT U.userid, Count(*) totalanwer from Sib_Users U INNER JOIN Sib_Forum_Answer A on U.userid = A.authorID WHERE U.userid = ? AND U.userType= "M" GROUP BY U.userid
GET_TOP_MENTORS_BY_LIKE_RATE_SUBS=SELECT X.* FROM(SELECT U.userid, CONCAT(U.lastName,' ', U.firstName) userName,IFNULL(U.lastName,''), IFNULL(U.firstName,''), U.imageUrl, U.isOnline, (SELECT IFNULL(SUM(numLike),0) from Sib_Forum_Answer where authorID = U.userid ) numlike, ( SELECT count(*) FROM Sib_Student_Subcribe Where U.userid = MentorId AND Subcribe = 'Y' ) numsub ,COUNT(V.vid) as numvideos ,U.defaultSubjectId, U.accomplishments, U.bio, (SELECT Count(*) from Sib_Forum_Answer WHERE authorID = U.userid ) numAnswers,AVG(V.averageRating) avgrate 
GET_VIDEOS_BY_PLAYLIST=SELECT L.`Name` AS playlistname, V.vid,IFNULL(U.firstName,'') firstName,IFNULL(U.lastName,'') lastName,U.imageUrl,V.title, V.description, V.numViews, V.numComments, UNIX_TIMESTAMP(V.timeStamp) as timeStamp,L.subjectId,U.userid ,V.image, c.subject FROM Sib_PlayList L INNER JOIN Sib_PlayList_Videos PV ON PV.plid = L.plid INNER JOIN Sib_Videos V ON PV.vid = V.vid INNER JOIN Sib_Users U ON U.userid = L.CreateBy INNER JOIN Sib_Category c ON V.subjectId = c.subjectId WHERE L.plid = ?
CHECK_SUBSCRIBE=SELECT count(*) isSubs FROM Sib_Student_Subcribe where Subcribe ='Y' AND MentorId = ?  AND StudentId \=?
GET_STUDENT_POSTED = SELECT  P.PID,  IFNULL(U.FIRSTNAME,'') FIRSTNAME, IFNULL(U.LASTNAME,'') LASTNAME,  P.AUTHORID,  P.TITLE,  P.SUBJECTID,  C. SUBJECT,  P.CONTENT,  P.NUMVIEWS,  P.NUMREPLIES,  UNIX_TIMESTAMP(P. TIMESTAMP) TIMESTAMP,  P.IMAGEPATH FROM  Sib_Forum_Post P INNER JOIN Sib_Category C ON P.subjectId = C.subjectId INNER JOIN Sib_Users U ON U.userid = P.authorID WHERE 1 = 1
GET_STUDENT_POSTED_COUNT = SELECT  COUNT(*) numquestion from Sib_Forum_Post P INNER JOIN Sib_Category C ON P.subjectId = C.subjectId WHERE 1 = 1
SUBSCRIBE_UNSUBSCRIBE_MENTOR= UPDATE Sib_Student_Subcribe set Subcribe = (CASE WHEN Subcribe ='Y' THEN 'N' ELSE 'Y' END) WHERE StudentId  = ? AND MentorId = ?
GET_POST_BY_ID=SELECT SFP.imagePath,SU.userName, IFNULL(SU.firstName,'') firstName, IFNULL(SU.lastName,'') lastName, SU.imageUrl, SU.idFacebook, SU.idGoogle, SFP.pid, SFP.authorID, SFP.title, SFP.subjectId, C.`subject`, SFP.content, SFP.numViews, SFP.numReplies, UNIX_TIMESTAMP(SFP. TIMESTAMP) TIMESTAMP, UNIX_TIMESTAMP(SFP.updateTime) updateTime, SFP.enableFlag FROM Sib_Forum_Post AS SFP JOIN Sib_Users AS SU ON authorID = userid INNER JOIN Sib_Category C on SFP.subjectId = C.subjectId WHERE SFP.pid = ?;
GET_ANSWER_BY_QID = SELECT X.* FROM ( SELECT A.authorID, A.content,A.imagePath imageAnswer, A.pid,IFNULL(U.firstName,''), IFNULL(U.lastName,''), (SELECT count(*) FROM Sib_Answer_like WHERE aid = A.aid) numlike, U.imageUrl, A.aid, UNIX_TIMESTAMP(A. TIMESTAMP) TIMESTAMP, UNIX_TIMESTAMP(A.updateTime) updateTime FROM Sib_Forum_Answer AS A JOIN Sib_Users AS U ON A.authorID = U.userid WHERE A.pid = ? ) X
POST_EDIT=UPDATE Sib_Forum_Post set imagePath = ?,content=? ,subjectId = ?,`timeStamp` = current_timestamp, updateTime = current_timestamp where pid= ?
GET_VIDEODETAIL_BY_ID = SELECT A.vid, A.title, A.url, A.description, A.image, A.averageRating, IFNULL(U.firstName,'') firstName, IFNULL(U.lastName,'') lastName, UNIX_TIMESTAMP(A.`timeStamp`) timeStamp, A.subjectId, C.`subject`,A.numViews,U.imageUrl avatar,( SELECT count(*) FROM Sib_Student_Subcribe Where U.userid = MentorId AND Subcribe='Y' ) numsub,U.userid  FROM Sib_Videos A INNER JOIN Sib_Users U on A.authorID = U.userid INNER JOIN Sib_Category C on A.subjectId = C.subjectId where A.vid = ?;
GET_COMMENT_VIDEO_BY_VID = SELECT D.content, IFNULL(U.firstName,'') firstName,IFNULL(U.lastName,'') lastName,U.imageUrl,U.userid ,UNIX_TIMESTAMP(D.`timestamp`) `timestamp` from Sib_Video_Comments C INNER JOIN Sib_Comments D ON C.cid = D.cid INNER JOIN Sib_Users U ON D.authorId = U.userid where C.vid = ? ORDER BY D.`timestamp` DESC
CHECK_USER_HISTORY_VIDEO=SELECT * FROM Sib_Video_History WHERE uid = ? AND vid = ?
INSERT_HISTORY_VIDEO=INSERT INTO Sib_Video_History(uid,vid,viewtime) VALUES(?,?,now())
GET_VIDEO_BY_SUBJECTID = SELECT A.vid, A.title, A.url, A.description, A.image, A.averageRating,U.userid, IFNULL(U.firstName,'') firstName,IFNULL( U.lastName,'') lastName, UNIX_TIMESTAMP(A.`timeStamp`) timeStamp, A.subjectId, C.`subject`,A.numViews FROM Sib_Videos A INNER JOIN Sib_Users U on A.authorID = U.userid INNER JOIN Sib_Category C on A.subjectId = C.subjectId where A.subjectId = ?
UPDATE_AVG_RATE = UPDATE Sib_Videos set averageRating = IFNULL(( SELECT (IFNULL(SUM(rating),0)+ ?) /(COUNT(*)+1),updateTime = current_timestamp FROm Sib_Video_Rating where vid = ? GROUP BY vid ),?),numRatings = numRatings + 1 where vid = ?
UPDATE_NUMREPLIES_QUESTION = UPDATE Sib_Forum_Post set numreplies = (ifnull(numreplies,0) + 1),updateTime = current_timestamp where pid = ?
CREATE_ANSWER=INSERT INTO Sib_Forum_Answer(pid, authorID, content,imagePath, timeStamp, updateTime, enableFlag) VALUES (?, ?, ?,?, now(), now(), 'Y');
CHECK_VIDEO_FAVOURITE = SELECT vid num from Sib_Video_Favourite where vid =? and uid = ?
